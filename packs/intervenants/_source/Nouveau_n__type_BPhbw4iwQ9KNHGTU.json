{
  "folder": "LqEmwmVBPVc6xSsz",
  "name": "Nouveau-né type",
  "type": "character",
  "_id": "BPhbw4iwQ9KNHGTU",
  "img": "icons/svg/mystery-man.svg",
  "system": {
    "hidden": [
      {
        "name": "healthMalus",
        "value": "${min(\n  (\n    10 == stun ? -2 : (\n      20 == stun ? -2 : (\n        60 == health ? -1 : (\n          70 == health ? -2 : 0\n        )\n      )\n    )\n  )\n)}$"
      },
      {
        "name": "stunStatus",
        "value": "${switchCase(stun, \"0\", \"Tout va bien\", \"10\", \"Le personnage subit un malus de 2 points à toutes ses chances de réussite au cours du tour suivant et uniquement celui-ci.\", \"20\", \"Le personnage subit un malus de 2 points à toutes ses chances de réussite jusqu'à ce qu'il puisse récupérer en se reposant environ cinq minutes. \\nS'il est sonné une seconde fois avant de s'être reposé, il est considéré comme Assommé.\", \"30\", \"Le personnage s'évanouit pour (d10) minutes s’il est convenablement soigné. \\nSans aucune aide extérieure l'évanouissement sera cinq fois plus long.\")}$"
      },
      {
        "name": "healthStatus",
        "value": "${switchCase(health, \"0\", \"Tout va bien\", \"50\", \"L'attaque n'a qu'un effet sanguinolent sans aucune conséquence grave. \\nLe sang coule, mais un bon pansement devrait pouvoir l'arrêter et éviter que la cicatrice ne soit trop visible.\", \"60\", \"Le personnage est meurtri dans sa chair mais sans que cela ait des conséquences vraiment fâcheuses. \\nLa douleur cause un malus de 1 point à toutes ses chances de réussite tant que la blessure n'est pas soignée (ce qui prend généralement quelques jours). \\nUne seconde blessure légère reçue moins d'une heure après la première cause une blessure grave (après une heure, la blessure reste légère).\", \"70\", \"Le personnage est blessé à un endroit grave. \\nLa douleur et la gêne causées par la blessure donnent un malus de 2 points à toutes ses chances de réussite tant que la blessure n'est pas soignée (ce qui prend généralement plusieurs semaines d'hôpital). \\nUne seconde blessure grave reçue moins d'une heure après la première cause un coma immédiat (après une heure, la blessure reste grave).\", \"80\", \"Le personnage est aux portes de la mort. \\nIl lutte de toutes ses forces pour rester en vie mais sombre néanmoins dans un profond coma. \\nIl ne pourra être réanimé qu'avec des moyens médicaux importants. \\nS'il n'est pas secouru avant une heure, il meurt sans jamais reprendre conscience. \\nUn second coma moins d'une heure après le premier cause la mort immédiate de la victime (après un heure, la blessure reste un coma).\", \"90\", \"Le personnage est mortellement touché. \\nIl peut à la rigueur s'en sortir avec des séquelles s'il est soigné rapidement (dans les 5 minutes) et s'il est ensuite suivi médicalement avec des appareils médicaux de haute technologie.\")}$"
      },
      {
        "name": "ccArmorEquiped",
        "value": "${0}$"
      },
      {
        "name": "distanceArmorEquiped",
        "value": "${0}$"
      },
      {
        "name": "maxMana",
        "value": "${2 == generation ? 25 : 3 == generation ? 100 : 4 == generation ? 500 : 5}$"
      },
      {
        "name": "recoveryMana",
        "value": "${4 == generation ? \"1 par minute\" : 3 == generation ? \"1 par minute\" : 2 == generation ? \"1 par heure\" : 1 == generation ? \"1 par heure\" : \"1 par jour\"}$"
      },
      {
        "name": "initiative",
        "value": "${fightnessForAttack + first(fetchFromDynamicTable('characteristics', 'value', 'name', characteristicForInitiative), 0)}$"
      },
      {
        "name": "resistanceModificator",
        "value": "${first(fetchFromDynamicTable('characteristics', 'value', 'name', resistanceCharacteristic), 0)}$"
      },
      {
        "name": "fightnessForAttack",
        "value": "${fightness > 0 ? fightness : fightnessPowerCheckbox ? 0 : fightness}$"
      },
      {
        "name": "fightnessForDefense",
        "value": "${0 > fightness ? fightness : fightnessPowerCheckbox ? 0 : fightness}$"
      }
    ],
    "header": {
      "contents": [
        {
          "key": "",
          "cssClass": "",
          "role": "3",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "Type de personnage",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "bold",
              "type": "label"
            },
            {
              "key": "type",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": "",
              "defaultValue": "0",
              "size": "m-large",
              "options": [
                {
                  "key": "0",
                  "value": "Etre humain"
                },
                {
                  "key": "1",
                  "value": "Etre magique"
                },
                {
                  "key": "2",
                  "value": "Dragon"
                },
                {
                  "key": "3",
                  "value": "Technomancien"
                }
              ],
              "tableKey": null,
              "tableKeyColumn": null,
              "tableLabelColumn": null,
              "formulaKeyOptions": null,
              "formulaLabelOptions": null,
              "type": "select"
            }
          ],
          "flow": "grid-2",
          "align": "left",
          "type": "panel"
        },
        {
          "key": "",
          "cssClass": "",
          "role": "3",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "1 == type ? true : false",
          "contents": [
            {
              "key": "",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "Emergence",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "bold",
              "type": "label"
            },
            {
              "key": "emergence",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": "",
              "defaultValue": "0",
              "size": "m-large",
              "options": [
                {
                  "key": "0",
                  "value": "Phase humaine"
                },
                {
                  "key": "1",
                  "value": "Phase de frémissement"
                },
                {
                  "key": "2",
                  "value": "Phase de la connaissance"
                },
                {
                  "key": "3",
                  "value": "Phase du voyage"
                },
                {
                  "key": "4",
                  "value": "Phase de la transformation"
                }
              ],
              "tableKey": null,
              "tableKeyColumn": null,
              "tableLabelColumn": null,
              "formulaKeyOptions": null,
              "formulaLabelOptions": null,
              "type": "select"
            },
            {
              "key": "natureGM",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": "Nature de l'être magique",
              "defaultValue": "",
              "size": "full-size",
              "charList": "",
              "maxLength": "",
              "type": "textField"
            },
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "displayNature",
                  "cssClass": "",
                  "role": "3",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "label": "Afficher la nature au joueur",
                  "defaultValue": null,
                  "size": "full-size",
                  "type": "checkbox",
                  "defaultChecked": false
                }
              ],
              "flow": "horizontal",
              "align": "right",
              "type": "panel"
            }
          ],
          "flow": "grid-2",
          "align": "left",
          "type": "panel"
        },
        {
          "key": "",
          "cssClass": "",
          "role": "3",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "2 == type ? true : false",
          "contents": [
            {
              "key": "",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "Génération",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "bold",
              "type": "label"
            },
            {
              "key": "generation",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": "",
              "defaultValue": "1",
              "size": "m-large",
              "options": [
                {
                  "key": "0",
                  "value": "Nouveau-né"
                },
                {
                  "key": "1",
                  "value": "Enfant dragon"
                },
                {
                  "key": "2",
                  "value": "Parent dragon"
                },
                {
                  "key": "3",
                  "value": "Grand-parent"
                },
                {
                  "key": "4",
                  "value": "Dragon céleste"
                }
              ],
              "tableKey": null,
              "tableKeyColumn": null,
              "tableLabelColumn": null,
              "formulaKeyOptions": null,
              "formulaLabelOptions": null,
              "type": "select"
            },
            {
              "key": "",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "Famille",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "bold",
              "type": "label"
            },
            {
              "key": "dragonFamily",
              "cssClass": "",
              "role": "3",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": "",
              "defaultValue": "",
              "size": "full-size",
              "options": [
                {
                  "key": "Dragon argenté",
                  "value": "Dragon argenté"
                },
                {
                  "key": "Dragon asiatique",
                  "value": "Dragon asiatique"
                },
                {
                  "key": "Dragon blanc",
                  "value": "Dragon blanc"
                },
                {
                  "key": "Dragon bleu",
                  "value": "Dragon bleu"
                },
                {
                  "key": "Dragon doré",
                  "value": "Dragon doré"
                },
                {
                  "key": "Dragon féérique",
                  "value": "Dragon féérique"
                },
                {
                  "key": "Dragon noir",
                  "value": "Dragon noir"
                },
                {
                  "key": "Dragon rouge",
                  "value": "Dragon rouge"
                },
                {
                  "key": "Dragon vert",
                  "value": "Dragon vert"
                },
                {
                  "key": "Hydre",
                  "value": "Hydre"
                },
                {
                  "key": "Serpent à plumes",
                  "value": "Serpent à plumes"
                },
                {
                  "key": "Serpent de mer",
                  "value": "Serpent de mer"
                },
                {
                  "key": "Wyvern",
                  "value": "Wyvern"
                }
              ],
              "tableKey": null,
              "tableKeyColumn": null,
              "tableLabelColumn": null,
              "formulaKeyOptions": null,
              "formulaLabelOptions": null,
              "type": "select"
            }
          ],
          "flow": "grid-2",
          "align": "left",
          "type": "panel"
        },
        {
          "key": "",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "${1 == type ? switchCase(emergence, \"1\", \"Etre magique en phase de frémissement\", \"2\", \"Etre magique en phase de connaissance\", \"3\", \"Etre magique en phase du voyage\", \"4\", \"Etre magique en phase de transformation\", \"\") : 2 == type ? switchCase(generation, \"0\", \"Nouveau-né\", \"1\", \"Enfant dragon\", \"2\", \"Parent dragon\", \"3\", \"Grand-parent\", \"4\", \"Dragon céleste\", \"\") : 3 == type ? \"Technomancien\" : \"\"}$",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "title",
              "type": "label"
            },
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": " ${2 == type ? dragonFamily : and(1 == type, displayNature) ? natureGM : \"\"}$",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "title",
              "type": "label"
            }
          ],
          "flow": "horizontal",
          "align": "center",
          "type": "panel"
        },
        {
          "key": "",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [],
          "flow": "vertical",
          "align": "center",
          "type": "panel"
        },
        {
          "key": "",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "age",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "Age",
              "visibilityFormula": "",
              "label": "Age",
              "defaultValue": "25",
              "size": "small",
              "allowDecimal": false,
              "minVal": "0",
              "maxVal": "",
              "allowRelative": false,
              "showControls": false,
              "controlsStyle": "hover",
              "type": "numberField"
            },
            {
              "key": "gender",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "Genre",
              "visibilityFormula": "",
              "label": "Genre",
              "defaultValue": "",
              "size": "full-size",
              "charList": "",
              "maxLength": "",
              "type": "textField"
            },
            {
              "key": "nationality",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "Nationalité",
              "visibilityFormula": "",
              "label": "Nationalité",
              "defaultValue": "",
              "size": "full-size",
              "charList": "",
              "maxLength": "",
              "type": "textField"
            }
          ],
          "flow": "horizontal",
          "align": "justify",
          "type": "panel"
        }
      ],
      "key": "custom_header",
      "cssClass": null,
      "role": 0,
      "permission": 0,
      "tooltip": null,
      "visibilityFormula": null,
      "flow": null,
      "align": null,
      "type": "panel"
    },
    "body": {
      "contents": [
        {
          "key": "healthPanel",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "Etat de santé du personnage",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "${stunStatus}$",
                  "visibilityFormula": "",
                  "label": null,
                  "defaultValue": null,
                  "size": "full-size",
                  "icon": "",
                  "value": "Moniteur étourdissement",
                  "prefix": "",
                  "suffix": "",
                  "rollMessage": "",
                  "altRollMessage": "",
                  "style": "bold",
                  "type": "label"
                },
                {
                  "key": "stun",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "${stunStatus}$",
                  "visibilityFormula": "",
                  "label": "",
                  "defaultValue": "0",
                  "size": "full-size",
                  "options": [
                    {
                      "key": "0",
                      "value": "En bonne santé"
                    },
                    {
                      "key": "10",
                      "value": "Légèrement sonné"
                    },
                    {
                      "key": "20",
                      "value": "Sonné"
                    },
                    {
                      "key": "30",
                      "value": "Assommé"
                    }
                  ],
                  "tableKey": null,
                  "tableKeyColumn": null,
                  "tableLabelColumn": null,
                  "formulaKeyOptions": null,
                  "formulaLabelOptions": null,
                  "type": "select"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "label": null,
                  "defaultValue": null,
                  "size": "full-size",
                  "icon": "",
                  "value": "${stunStatus}$",
                  "prefix": "",
                  "suffix": "",
                  "rollMessage": "",
                  "altRollMessage": "",
                  "style": "label",
                  "type": "label"
                }
              ],
              "flow": "vertical",
              "align": "justify",
              "type": "panel"
            },
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "${healthStatus}$",
                  "visibilityFormula": "",
                  "label": null,
                  "defaultValue": null,
                  "size": "full-size",
                  "icon": "",
                  "value": "Moniteur de santé",
                  "prefix": "",
                  "suffix": "",
                  "rollMessage": "",
                  "altRollMessage": "",
                  "style": "bold",
                  "type": "label"
                },
                {
                  "key": "health",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "${healthStatus}$",
                  "visibilityFormula": "",
                  "label": "",
                  "defaultValue": "0",
                  "size": "full-size",
                  "options": [
                    {
                      "key": "0",
                      "value": "En bonne santé"
                    },
                    {
                      "key": "50",
                      "value": "Egratignure"
                    },
                    {
                      "key": "60",
                      "value": "Blessure légère"
                    },
                    {
                      "key": "70",
                      "value": "Blessure grave"
                    },
                    {
                      "key": "80",
                      "value": "Coma"
                    },
                    {
                      "key": "90",
                      "value": "Mort"
                    }
                  ],
                  "tableKey": null,
                  "tableKeyColumn": null,
                  "tableLabelColumn": null,
                  "formulaKeyOptions": null,
                  "formulaLabelOptions": null,
                  "type": "select"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "label": null,
                  "defaultValue": null,
                  "size": "full-size",
                  "icon": "",
                  "value": "${healthStatus}$",
                  "prefix": "",
                  "suffix": "",
                  "rollMessage": "",
                  "altRollMessage": "",
                  "style": "label",
                  "type": "label"
                }
              ],
              "flow": "vertical",
              "align": "justify",
              "type": "panel"
            }
          ],
          "flow": "grid-2",
          "align": "center",
          "type": "panel"
        },
        {
          "key": "healthMalusPanel",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "healthMalusLabel",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "Impact de l'état de santé :",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "bold",
              "type": "label"
            },
            {
              "key": "",
              "cssClass": "",
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "label": null,
              "defaultValue": null,
              "size": "full-size",
              "icon": "",
              "value": "<strong>${healthMalus}$</strong>",
              "prefix": "",
              "suffix": "",
              "rollMessage": "",
              "altRollMessage": "",
              "style": "label",
              "type": "label"
            }
          ],
          "flow": "horizontal",
          "align": "justify",
          "type": "panel"
        },
        {
          "key": "characterTabbedPanel",
          "cssClass": "",
          "role": "0",
          "permission": "0",
          "tooltip": "",
          "visibilityFormula": "",
          "contents": [
            {
              "key": "characterTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "Description du personnage",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "<strong>Description</strong>",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "subtitle",
                      "type": "label"
                    },
                    {
                      "key": "description",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "",
                      "size": null,
                      "style": "dialog",
                      "type": "textArea"
                    }
                  ],
                  "flow": "vertical",
                  "align": "left",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "characteristics",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "rowLayout": [
                        {
                          "key": "name",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "charList": "",
                          "maxLength": "",
                          "type": "textField",
                          "align": "left",
                          "colName": "Caractéristiques"
                        },
                        {
                          "key": "value",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "valeur de -8 à +8",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "0",
                          "size": "small",
                          "allowDecimal": false,
                          "minVal": "-8",
                          "maxVal": "+8",
                          "allowRelative": false,
                          "showControls": false,
                          "controlsStyle": "hover",
                          "type": "numberField",
                          "align": "right",
                          "colName": "Valeurs"
                        }
                      ],
                      "head": true,
                      "deleteWarning": true,
                      "predefinedLines": [],
                      "canPlayerAdd": true,
                      "type": "dynamicTable"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "carriers",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "Métiers",
                          "visibilityFormula": "",
                          "rowLayout": [
                            {
                              "key": "name",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": "medium",
                              "charList": "",
                              "maxLength": "",
                              "type": "textField",
                              "align": "left",
                              "colName": "Métiers"
                            },
                            {
                              "key": "level",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "4",
                              "size": "full-size",
                              "options": [
                                {
                                  "key": "4",
                                  "value": "Débutant"
                                },
                                {
                                  "key": "2",
                                  "value": "Qualifié"
                                },
                                {
                                  "key": "0",
                                  "value": "Expert"
                                }
                              ],
                              "tableKey": null,
                              "tableKeyColumn": null,
                              "tableLabelColumn": null,
                              "formulaKeyOptions": null,
                              "formulaLabelOptions": null,
                              "type": "select",
                              "align": "left",
                              "colName": ""
                            },
                            {
                              "key": "characteristic",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "Choisir la caractéristique appropriée",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": "full-size",
                              "options": [],
                              "tableKey": "characteristics",
                              "tableKeyColumn": "name",
                              "tableLabelColumn": "",
                              "formulaKeyOptions": null,
                              "formulaLabelOptions": null,
                              "type": "select",
                              "align": "left",
                              "colName": ""
                            },
                            {
                              "key": "roll",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": null,
                              "defaultValue": null,
                              "size": "full-size",
                              "icon": "dice-d10",
                              "value": "",
                              "prefix": "",
                              "suffix": "",
                              "rollMessage": "<!-- Roll for carrier/hobby -->\n\n${#concat(\n  ?{diff:\"Difficulté\"|\"2\",\"Normal\"|\"0\",\"Facile\"|\"4\",\"Difficile\"},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#sante:=healthMalus}$\n\n<!-- caractéristique -->\n${#caracteristiqueName:= sameRow('characteristic', false)}$\n${#caracteristique:= first(fetchFromDynamicTable('characteristics', 'value', 'name', caracteristiqueName), 0)}$\n\n<!-- seuil et bonus si seuil > 10 -->\n${#seuil:= 10 - sameRow('level') - diff}$        \n${#bonus:=((seuil + caracteristique + sante) > 10 ? seuil + caracteristique + sante - 10 : 0)}$\n\n<!-- jet et affichage -->\n<h3>Jet ${!(0 == diff ? \"facile\" : (2 == diff ? \"normal\":\"difficile\"))}$ de <strong>${!sameRow('name')}$</strong>${!0 != caracteristique ? concat(' avec ', caracteristiqueName) : \"\"}$</h3>\n\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + caracteristique + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- remise à zéro de la caractéristique utilisée -->\n${#setPropertyInEntity('self', sameRowRef('characteristic'), 0)}$",
                              "altRollMessage": "",
                              "style": "label",
                              "type": "label",
                              "align": "left",
                              "colName": ""
                            }
                          ],
                          "head": true,
                          "deleteWarning": true,
                          "predefinedLines": [
                            {
                              "deleted": true
                            },
                            {
                              "deleted": true
                            }
                          ],
                          "canPlayerAdd": true,
                          "type": "dynamicTable"
                        },
                        {
                          "key": "hobbies",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "Hobbies",
                          "visibilityFormula": "",
                          "rowLayout": [
                            {
                              "key": "name",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": "medium",
                              "charList": "",
                              "maxLength": "",
                              "type": "textField",
                              "align": "left",
                              "colName": "Hobbies"
                            },
                            {
                              "key": "level",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "4",
                              "size": "full-size",
                              "options": [
                                {
                                  "key": "4",
                                  "value": "Amateur"
                                },
                                {
                                  "key": "2",
                                  "value": "Averti"
                                },
                                {
                                  "key": "0",
                                  "value": "Spécialiste"
                                }
                              ],
                              "tableKey": null,
                              "tableKeyColumn": null,
                              "tableLabelColumn": null,
                              "formulaKeyOptions": null,
                              "formulaLabelOptions": null,
                              "type": "select",
                              "align": "left",
                              "colName": ""
                            },
                            {
                              "key": "characteristic",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "Choisir la caractéristique appropriée",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": "full-size",
                              "options": [],
                              "tableKey": "characteristics",
                              "tableKeyColumn": "name",
                              "tableLabelColumn": "",
                              "formulaKeyOptions": null,
                              "formulaLabelOptions": null,
                              "type": "select",
                              "align": "left",
                              "colName": ""
                            },
                            {
                              "key": "roll",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "Lancer les dés !",
                              "visibilityFormula": "",
                              "label": null,
                              "defaultValue": null,
                              "size": "full-size",
                              "icon": "dice-d10",
                              "value": "",
                              "prefix": "",
                              "suffix": "",
                              "rollMessage": "<!-- Roll for carrier/hobby -->\n\n${#concat(\n  ?{diff:\"Difficulté\"|\"2\",\"Normal\"|\"0\",\"Facile\"|\"4\",\"Difficile\"},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#sante:=healthMalus}$\n\n<!-- caractéristique -->\n${#caracteristiqueName:= sameRow('characteristic', false)}$\n${#caracteristique:= first(fetchFromDynamicTable('characteristics', 'value', 'name', caracteristiqueName), 0)}$\n\n<!-- seuil et bonus si seuil > 10 -->\n${#seuil:= 10 - sameRow('level') - diff}$        \n${#bonus:=((seuil + caracteristique + sante) > 10 ? seuil + caracteristique + sante - 10 : 0)}$\n\n<!-- jet et affichage -->\n<h3>Jet ${!(0 == diff ? \"facile\" : (2 == diff ? \"normal\":\"difficile\"))}$ de <strong>${!sameRow('name')}$</strong>${!0 != caracteristique ? concat(' avec ', caracteristiqueName) : \"\"}$</h3>\n\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + caracteristique + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- remise à zéro de la caractéristique utilisée -->\n${#setPropertyInEntity('self', sameRowRef('characteristic'), 0)}$",
                              "altRollMessage": "",
                              "style": "label",
                              "type": "label",
                              "align": "left",
                              "colName": ""
                            }
                          ],
                          "head": true,
                          "deleteWarning": true,
                          "predefinedLines": [
                            {
                              "deleted": true
                            }
                          ],
                          "canPlayerAdd": true,
                          "type": "dynamicTable"
                        }
                      ],
                      "flow": "vertical",
                      "align": "left",
                      "type": "panel"
                    }
                  ],
                  "flow": "horizontal",
                  "align": "left",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "unskilledCharacteristic",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Caractéristique utilisée",
                      "defaultValue": "",
                      "size": "full-size",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    },
                    {
                      "key": "unskilledRoll",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "dice-d10",
                      "value": "Jet en tant que non qualifié",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- Roll for unskilled carrier/hobby -->\n${#concat(\n  ?{diff:\"Difficulté\"|2,\"Normal\"|0,\"Facile\"|4,\"Difficile\"},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#sante:=healthMalus}$\n${#caracteristique:= first(fetchFromDynamicTable('characteristics', 'value', 'name', unskilledCharacteristic), 0)}$\n${#seuil:= 10 - 6 - diff}$        \n${#bonus:=((seuil + caracteristique + modificateur + sante) > 10 ? seuil + caracteristique + modificateur + sante - 10 : 0)}$\n\n<h3>Jet ${!(0 == diff ? \"facile\" : (2 == diff ? \"normal\":\"difficile\"))}$ <strong>Non qualifié</strong>${!0 != caracteristique ? concat(' avec ', unskilledCharacteristic) : \"\"}$</h3>\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + caracteristique + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- remise à zéro de la caractéristique utilisée -->\n${#setPropertyInEntity('self', 'unskilledCharacteristic', 0)}$",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    }
                  ],
                  "flow": "grid-2",
                  "align": "left",
                  "type": "panel"
                }
              ],
              "name": "Personnage",
              "type": "tab"
            },
            {
              "key": "stuffTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Equipement",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "title",
                          "type": "label"
                        },
                        {
                          "key": "stuff",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": null,
                          "style": "dialog",
                          "type": "textArea"
                        }
                      ],
                      "flow": "vertical",
                      "align": "left",
                      "type": "panel"
                    },
                    {
                      "key": "objects",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "rowLayout": [],
                      "head": false,
                      "deleteWarning": true,
                      "title": "<strong>Objets</strong>",
                      "hideEmpty": true,
                      "headDisplay": false,
                      "showDelete": true,
                      "statusIcon": false,
                      "nameAlign": "left",
                      "nameLabel": "Nom",
                      "templateFilter": [
                        "V67YO7hbO1tfTZdx"
                      ],
                      "itemFilter": [],
                      "type": "itemContainer"
                    }
                  ],
                  "flow": "grid-2",
                  "align": "left",
                  "type": "panel"
                }
              ],
              "name": "Equipement",
              "type": "tab"
            },
            {
              "key": "fightTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "characteristicForInitiative",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Choisir la caractéristique pour l'initiative",
                      "visibilityFormula": "",
                      "label": "Initiative",
                      "defaultValue": "",
                      "size": "medium",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    },
                    {
                      "key": "fightness",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Combativité",
                      "defaultValue": "0",
                      "size": "medium",
                      "allowDecimal": false,
                      "minVal": "-3",
                      "maxVal": "3",
                      "allowRelative": false,
                      "showControls": false,
                      "controlsStyle": "hover",
                      "type": "numberField"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${initiative}$",
                      "prefix": "Modification de l'initiative : ",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    },
                    {
                      "key": "fightnessPowerCheckbox",
                      "cssClass": "",
                      "role": "3",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Pouvoir de Combativité",
                      "defaultValue": null,
                      "size": "full-size",
                      "type": "checkbox",
                      "defaultChecked": false
                    }
                  ],
                  "flow": "grid-3",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "weapons",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "Placer les armes ici",
                  "visibilityFormula": "",
                  "rowLayout": [
                    {
                      "key": "type",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${switchCase(item.combatType, \"1\", \"Corps-à-corps\", \"2\", \"Contact\", \"3\", \"Distance\", \"<i>Non défini</i>\")}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Type"
                    },
                    {
                      "key": "powerfull",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Puissance",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${switchCase(item.powerfullMax, \"1\", \"Faible\", \"2\", \"Moyenne\", \"3\", \"Importante\", \"4\", \"Remarquable\", item.powerfullMax)}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Puissance"
                    },
                    {
                      "key": "bonus",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.attackBonus}$ / ${item.damageBonus}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Bonus attaque/dégâts"
                    },
                    {
                      "key": "attack",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Faire un jet d'attaque",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "dice-d10",
                      "value": "",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- Roll for attack -->\n${#concat(\n  ?{diff:\"Difficulté\"|\"2\",\"Normal\"|\"0\",\"Facile\"|\"4\",\"Difficile\"},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n<!-- vérification qu'une cible a bien été sélectionnée -->\n${#nameTarget:= fetchFromActor(\"target\", \"name\", \"\")}$\n${#(nameTarget?\"\":notify(\"error\", \"Vous devez sélectionner une cible !\"))}$\n\n<!-- récupération des données -->\n${#sante:=       healthMalus}$\n${#combativite:= fightnessForAttack}$\n${#type:=        item.combatType}$\n${#bonusArme:=   item.attackBonus ? item.attackBonus : 0}$\n\n<!-- définition des valeurs par défaut -->\n${#ccCombatCarrier:=       ccCombatCarrier       ? ccCombatCarrier       : \"\"}$\n${#ccCombatHobby:=         ccCombatHobby         ? ccCombatHobby         : \"\"}$\n${#contactCombatCarrier:=  contactCombatCarrier  ? contactCombatCarrier  : \"\"}$\n${#contactCombatHobby:=    contactCombatHobby    ? contactCombatHobby    : \"\"}$\n${#distanceCombatCarrier:= distanceCombatCarrier ? distanceCombatCarrier : \"\"}$\n${#distanceCombatHobby:=   distanceCombatHobby   ? distanceCombatHobby   : \"\"}$\n\n${#default:= 6}$\n${#ccCombatCarrierLevel:=       first(fetchFromDynamicTable('carriers', 'level', 'name', ccCombatCarrier),       default)}$\n${#ccCombatHobbyLevel:=         first(fetchFromDynamicTable('hobbies',  'level', 'name', ccCombatHobby),         default)}$\n${#contactCombatCarrierLevel:=  first(fetchFromDynamicTable('carriers', 'level', 'name', contactCombatCarrier),  default)}$\n${#contactCombatHobbyLevel:=    first(fetchFromDynamicTable('hobbies',  'level', 'name', contactCombatHobby),    default)}$\n${#distanceCombatCarrierLevel:= first(fetchFromDynamicTable('carriers', 'level', 'name', distanceCombatCarrier), default)}$\n${#distanceCombatHobbyLevel:=   first(fetchFromDynamicTable('hobbies',  'level', 'name', distanceCombatHobby),   default)}$\n\n<!-- définition du nom du métier ou du hobby de référence -->\n${#ccName:=       ccCombatCarrierLevel       >= ccCombatHobbyLevel       ? ccCombatHobby       : ccCombatCarrier}$\n${#contactName:=  contactCombatCarrierLevel  >= contactCombatHobbyLevel  ? contactCombatHobby  : contactCombatCarrier}$\n${#distanceName:= distanceCombatCarrierLevel >= distanceCombatHobbyLevel ? distanceCombatHobby : distanceCombatCarrier}$\n${#carrierHobby:= switchCase(type, \"1\", ccName, \"2\", contactName, \"3\", distanceName, \"\")}$\n${#carrierHobby:= equalText(\"\", carrierHobby) ? \"Non qualifié\" : carrierHobby}$\n\n<!-- définition du niveau du métier ou du hobby de référence -->\n${#ccLevel:=       ccCombatCarrierLevel       >= ccCombatHobbyLevel       ? ccCombatHobbyLevel       : ccCombatCarrierLevel}$\n${#contactLevel:=  contactCombatCarrierLevel  >= contactCombatHobbyLevel  ? contactCombatHobbyLevel  : contactCombatCarrierLevel}$\n${#distanceLevel:= distanceCombatCarrierLevel >= distanceCombatHobbyLevel ? distanceCombatHobbyLevel : distanceCombatCarrierLevel}$\n${#level:=switchCase(type, \"1\", ccLevel, \"2\", contactLevel, \"3\", distanceLevel, default)}$\n\n<!-- définition de la caractéristique de référence -->\n${#caracteristiqueName:= (1 == type ? ccCombatCharacteristic : 2 == type ? contactCombatCharacteristic : 3 == type ? distanceCombatCharacteristic : \"\")}$\n${#caracteristique:=     first(fetchFromDynamicTable('characteristics', 'value', 'name', caracteristiqueName), 0)}$\n\n<!-- combativité de la cible -->\n${#combativiteAdverse:= fetchFromActor('target', 'fightnessForDefense', 0)}$\n\n<!-- calcul du seuil de réussite -->\n${#seuil:= 10 - level - diff}$\n\n<!-- calcul du bonus si le seuil est supérieur à 10 -->\n${#seuilTemp:= seuil + caracteristique + combativite + combativiteAdverse + bonusArme + modificateur + sante}$\n${#bonus:=(seuilTemp > 10 ? seuilTemp - 10 : 0)}$\n\n<h3><strong>${!item.name}$</strong> : attaque ${!(0 == diff ? \"facile\" : (2 == diff ? \"normale\":\"difficile\"))}$ [${! carrierHobby}$${! 0 != caracteristique ? concat(\" / \", caracteristiqueName) : \"\"}$]</h3>\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:=seuil + caracteristique + combativite + combativiteAdverse + bonusArme + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Jet d'attaque"
                    },
                    {
                      "key": "damage",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Lancer les dommages",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "star-exclamation",
                      "value": "",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- Jet pour calculer les dégâts des armes aux corps-à-corps, contact et distance -->\n${#concat(\n  ?{powerfull:\"Puissance\"|1,concat(\"Faible\",(1==item.powerfullMax?\" (max)\":\"\"))|2,concat(\"Moyenne\",(2==item.powerfullMax?\" (max)\":\"\"))|3,concat(\"Importante\",(3==item.powerfullMax?\" (max)\":\"\"))|4,concat(\"Remarquable\",(4==item.powerfullMax?\" (max)\":\"\"))},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n<!-- vérification qu'une cible a bien été sélectionnée -->\n${#nameTarget:=       \u001c\u001c\u001c\u001c fetchFromActor(\"target\", \"name\", \"\")}$\n${#nameTarget ? \"\" : notify(\"error\", \"Vous devez sélectionner une cible !\")}$\n\n<!-- récupération des données -->\n${#combativite:=       fightnessForAttack}$\n${#type:=              item.combatType}$\n${#bonusArme:=         item.damageBonus ? item.damageBonus : 0}$\n${#protectionAdverse:= -1 * (3 == type ? fetchFromActor(\"target\", \"distanceArmorEquiped\", 0) : fetchFromActor(\"target\", \"ccArmorEquiped\", 0))}$\n\n<!-- bonus de la caracteristique si combat corps-à-corps ou contact -->\n${#bonusForce:=        3 == type ? 0 : first(fetchFromDynamicTable('characteristics', 'value', 'name', powerfullCharacteristic), 0)}$\n\n<!-- malus de la résistance de la cible -->\n${#resistanceAdverse:= -1 * fetchFromActor(\"target\", \"resistanceModificator\", 0)}$\n\n<!-- combativité de la cible -->\n${combativiteAdverse:= fetchFromActor(\"target\", \"fightnessForDefense\", 0)}$\n\n<h3>Dégats de puissance ${!switchCase(powerfull, \"1\", \"Faible\",\"2\", \"Moyenne\",\"3\", \"Importante\", \"4\", \"Remarquable\", \"<i>non définie</i>\")}$ sur <strong>@{target|name}</strong> par ${!name}$</h3>\n\n<!-- vérification de la puissance utilisée -->\n${!(powerfull > item.powerfullMax\n  ? \"<div style=\\\"padding: 2px; text-align: center; color: var(--color-level-warning); border: solid 1px var(--color-level-warning)\\\">La <strong>puissance choisie</strong> doit être <strong>inférieure ou</strong> égale à la <strong>puissance maximale</strong> de l'attaque</div>\"\n  :\"\"\n)}$\n\n<!--\ncode blessures :\n*  0 = Rien\n* 10 = Légèrement sonné\n* 20 = Sonné\n* 30 = Assommé\n* 40 = Dommage critique\n* 50 = Egratignure\n* 60 = Blessure légère\n* 70 = Blessure grave\n* 80 = Coma\n* 90 = Mort\n-->\n\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <i class=\"fas fa-dice-d10\"></i>\n        <span>${!roll:= [1d10]}$</span>\n      </td>\n    </tr>\n    <tr>\n      <td><h4>Dégâts</h4></td>\n      <td>\n        <strong>${roll:= roll + combativite + bonusForce + combativiteAdverse + resistanceAdverse + protectionAdverse + bonusArme + modificateur}$</strong>\n      </td>\n    </tr>\n${#damage:=switchCase(type, \"1\", switchCase(powerfull, \"1\", (3 >= roll ? 0:(7 >= roll ? 10 : 20)), \"2\", (3 >= roll ? 10 : (7 >= roll ? 20 : 30)), \"3\", (3 >= roll ? 20 : (7 >= roll ? 30 : 40))), \"2\", switchCase(powerfull, \"1\", (3 >= roll ? 0:(7 >= roll ? 50 : 60)), \"2\", (3 >= roll ? 50 : (7 >= roll ? 60 : 70)), \"3\", (3 >= roll ? 60 : (7 >= roll ? 70 : 80)), \"4\", (3 >= roll ? 70 : (7 >= roll ? 80 : 90))), \"3\", switchCase(powerfull, \"1\", (3 >= roll ? 0:(7 >= roll ? 60 : 70)), \"2\", (3 >= roll ? 60 : (7 >= roll ? 70 : 80)), \"3\", (3 >= roll ? 70 : (7 >= roll ? 80 : 90))))}$\n\n${#damageName:=switchCase(damage, 0, \"Rien\", 10, \"Légèrement sonné\", 20, \"Sonné\", 30, \"Assommé\", 40, \"Dommage critique\", 50, \"Egratignure\", 60, \"Blessure légère\", 70, \"Blessure grave\", 80, \"Coma\", 90, \"Mort\")}$\n\n${#damageDetail:=switchCase(damage, 0, \"Loupé !\", 10, \"Le personnage subit un <strong>malus de 2 points</strong> à toutes ses chances de réussite <strong>au cours du tour suivant</strong> et uniquement celui-ci.\", 20, \"Le personnage subit <strong>un malus de 2 points</strong> à toutes ses chances de réussite jusqu'à ce qu'il puisse récupérer en se reposant environ cinq minutes. <br/>S'il est sonné une seconde fois avant de s'être reposé, il est considéré comme Assommé.\", 30, \"Le personnage s'évanouit <strong>pour ${[1d10]}$ minutes</strong> s'il est convenablement soigné.</strong> <br/>Sans aucune aide extérieure l'évanouissement sera <strong>cinq fois plus long</strong>.\", 40, \"Le personnage est <strong>Assommé</strong>  pour <strong>${[1d10]}$ minutes</strong> et subit une <strong>Blessure Légère</strong>.\", 50, \"L'attaque n'a qu'un effet sanguinolent sans aucune conséquence grave. Le sang coule, mais un bon pansement devrait pouvoir l'arrêter et éviter que la cicatrice ne soit trop visible.\", 60, \"Le personnage est meurtri dans sa chair mais sans que cela ait des conséquences vraiment fâcheuses. La douleur cause un <strong>malus de 1 point</strong> à toutes ses chances de réussite tant que la blessure n'est pas soignée (ce qui prend généralement quelques jours). <br/>Une seconde blessure légère reçue moins d'une heure après la première cause une blessure grave (après une heure, la blessure reste légère).\", 70, \"Le personnage est blessé à un endroit grave. La douleur et la gêne causées par la blessure donnent un <strong>malus de 2 points</strong> à toutes ses chances de réussite tant que la blessure n'est pas soignée (ce qui prend généralement plusieurs semaines d'hôpital).<br/>Une seconde blessure grave reçue moins d'une heure après la première cause un coma immédiat (après une heure, la blessure reste grave).\", 80, \"Le personnage est aux portes de la mort. Il lutte de toutes ses forces pour rester en vie mais sombre néanmoins dans un profond coma. Il ne pourra être réanimé qu'avec des moyens médicaux importants. <strong>S'il n'est pas secouru avant une heure, il meurt sans jamais reprendre conscience</strong>.<br/>Un second coma moins d'une heure après le premier cause la mort immédiate de la victime (après un heure, la blessure reste un coma).\", 90, \"Le personnage est mortellement touché. Il peut à la rigueur s'en sortir avec des séquelles s'il est soigné rapidement (dans les 5 minutes) et s'il est ensuite suivi médicalement avec des appareils médicaux de haute technologie.\")}$\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; border: solid 1px var(--color-border-dark)\">\n          <strong>${!damageName}$</strong>\n        </p>\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: justify; border: solid 1px var(--color-border-dark)\">\n          ${!damageDetail}$\n        </p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- application des dégâts à la cible \nIF (dommage >= 50 AND dommage >= target.health) THEN\n  AppliquerDommageHealth()\nELSE\n  IF (dommage == 40 AND 60 > target.health) THEN\n    AppliquerDommageCritique()\n  ELSE\n    IF (30 >= dommage AND dommage >= target.stun) THEN\n      AppliquerDommageStun()\n    ELSE\n      // ne rien faire\n    FI\n  FI\nFI\n-->\n\n<!--\n\n${stunTarget:= fetchFromActor('target', 'stun')}$\n<br/>\n${healthTarget:= fetchFromActor('target', 'health')}$\n<br/>\n${#assomme:=30}$\n${#blessureLegere:=60}$\n${setPropertyInEntity('target', 'stun', ref(\"assomme\"))}$\n\n\n\n${$changement:=and(damage >= 50, damage > healthTarget)\n  ? ${setPropertyInEntity('target', 'health', \"damage\")}$\n  : and(40 == damage, 60 > healthTarget)\n    ? ${concat(\n      string(setPropertyInEntity('target', 'stun', \"assomme\")), \n      string(setPropertyInEntity('target', 'health', \"blessureLegere\")))}$\n    : and(30 >= damage, damage > stunTarget)\n      ? ${setPropertyInEntity('target', 'stun', \"damage\")}$\n      : \"pas de changement\"\n)}$\n-->",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Dégats"
                    }
                  ],
                  "head": true,
                  "deleteWarning": true,
                  "title": "<strong>Armes</strong>",
                  "hideEmpty": true,
                  "headDisplay": true,
                  "showDelete": true,
                  "statusIcon": false,
                  "nameAlign": "left",
                  "nameLabel": "Nom",
                  "templateFilter": [
                    "14jgxwvyYKfEIWkZ"
                  ],
                  "itemFilter": [],
                  "type": "itemContainer"
                },
                {
                  "key": "armors",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "rowLayout": [
                    {
                      "key": "ccArmor",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.ccArmor}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Protection au contact"
                    },
                    {
                      "key": "distanceArmor",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.distanceArmor}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Protection contre les armes à feu"
                    },
                    {
                      "key": "equiped",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${(item.equiped ? \"Oui\" : \"Non\")}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "${(item.equiped \n  ? \n    ${concat(\"retire \", item.name)}$\n    ${#setPropertyInEntity('item', 'equiped', \"\")}$\n  :\n    ${concat(\"équipe \", item.name)}$\n    ${#setPropertyInEntity('item', 'equiped', 1)}$\n)}$",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Equipée"
                    }
                  ],
                  "head": true,
                  "deleteWarning": true,
                  "title": "<strong>Armures</strong>",
                  "hideEmpty": true,
                  "headDisplay": true,
                  "showDelete": true,
                  "statusIcon": false,
                  "nameAlign": "left",
                  "nameLabel": "Nom",
                  "templateFilter": [
                    "EKpHmIAjQI656vcn"
                  ],
                  "itemFilter": [],
                  "type": "itemContainer"
                },
                {
                  "key": "carriersHobbiesPanel",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Corps-à-corps",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Contact",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Distance",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    },
                    {
                      "key": "",
                      "cssClass": "preferred-panel",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Métier préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "ccCombatCarrier",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "carriers",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Hobby préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "ccCombatHobby",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "hobbies",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Caractéristique préférée",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "ccCombatCharacteristic",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "characteristics",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        }
                      ],
                      "flow": "grid-2",
                      "align": "left",
                      "type": "panel"
                    },
                    {
                      "key": "",
                      "cssClass": "preferred-panel",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Métier préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "contactCombatCarrier",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "carriers",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Hobby préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "contactCombatHobby",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "hobbies",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Caractéristique préférée",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "contactCombatCharacteristic",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "characteristics",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        }
                      ],
                      "flow": "grid-2",
                      "align": "left",
                      "type": "panel"
                    },
                    {
                      "key": "",
                      "cssClass": "preferred-panel",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Métier préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "distanceCombatCarrier",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "carriers",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Hobby préféré",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "distanceCombatHobby",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "hobbies",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Caractéristique préférée",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "distanceCombatCharacteristic",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "full-size",
                          "options": [],
                          "tableKey": "characteristics",
                          "tableKeyColumn": "name",
                          "tableLabelColumn": "",
                          "formulaKeyOptions": null,
                          "formulaLabelOptions": null,
                          "type": "select"
                        }
                      ],
                      "flow": "grid-2",
                      "align": "left",
                      "type": "panel"
                    }
                  ],
                  "flow": "grid-3",
                  "align": "left",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "powerfullCharacteristic",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Pour la puissance des attaques (corps-à-corps et contact)",
                      "defaultValue": "",
                      "size": "full-size",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    },
                    {
                      "key": "resistanceCharacteristic",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Pour la résistance face aux attaques (corps-à-corps et contact)",
                      "defaultValue": "",
                      "size": "full-size",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    }
                  ],
                  "flow": "horizontal",
                  "align": "center",
                  "type": "panel"
                }
              ],
              "name": "Combat",
              "type": "tab"
            },
            {
              "key": "biographyTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "Tout savoir de la vie du personnage",
              "visibilityFormula": "",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Expérience",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "subtitle",
                      "type": "label"
                    },
                    {
                      "key": "xp",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Expérience du personnage",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "0",
                      "size": "medium",
                      "allowDecimal": false,
                      "minVal": "0",
                      "maxVal": "",
                      "allowRelative": true,
                      "showControls": false,
                      "controlsStyle": "hover",
                      "type": "numberField"
                    }
                  ],
                  "flow": "grid-2",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "panel",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "biographyPanel",
                      "cssClass": null,
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Biographie",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "contents": [
                            {
                              "key": "biography",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": null,
                              "style": "sheet",
                              "type": "textArea"
                            }
                          ],
                          "flow": "vertical",
                          "align": "left",
                          "type": "panel"
                        }
                      ],
                      "name": "Biographie",
                      "type": "tab"
                    },
                    {
                      "key": "privateBiographyPanel",
                      "cssClass": null,
                      "role": "0",
                      "permission": "3",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "contents": [
                            {
                              "key": "privateBiography",
                              "cssClass": "",
                              "role": "0",
                              "permission": "0",
                              "tooltip": "Biographie privée",
                              "visibilityFormula": "",
                              "label": "",
                              "defaultValue": "",
                              "size": null,
                              "style": "sheet",
                              "type": "textArea"
                            }
                          ],
                          "flow": "vertical",
                          "align": "left",
                          "type": "panel"
                        }
                      ],
                      "name": "Biographie privée",
                      "type": "tab"
                    }
                  ],
                  "type": "tabbedPanel"
                }
              ],
              "name": "Biographie",
              "type": "tab"
            },
            {
              "key": "innatePowersTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "or(and(1 == type, 0 < emergence), 2 == type) ? true : false",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "accessDraconicMagic",
                      "cssClass": "",
                      "role": "3",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Accès à la magie draconique",
                      "defaultValue": null,
                      "size": "full-size",
                      "type": "checkbox",
                      "defaultChecked": false
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "accessDraconicMagic",
                      "contents": [
                        {
                          "key": "draconicMagicLevel",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "Niveau",
                          "defaultValue": "",
                          "size": "m-small",
                          "allowDecimal": false,
                          "minVal": "0",
                          "maxVal": "",
                          "allowRelative": false,
                          "showControls": false,
                          "controlsStyle": "hover",
                          "type": "numberField"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "<p style=\"text-align: justify;\">Ce pouvoir inn&eacute; n&rsquo;est accessible <strong>qu&rsquo;aux dragons et aux &ecirc;tres magiques qui descendent directement des dragons</strong>. Le personnage poss&egrave;de des dons qui lui&nbsp;permettent d&rsquo;apprendre relativement facilement des sorts de magie draconique.</p>\n<p style=\"text-align: justify;\">Le niveau dans ce pouvoir indique le nombre total de sorts qu&rsquo;il peut apprendre, sans avoir &agrave; suivre la proc&eacute;dure longue et fastidieuse d&eacute;crite dans le chapitre concern&eacute;.&nbsp;</p>\n<p style=\"text-align: justify;\">Ce pouvoir est permanent.&nbsp;</p>\n<p style=\"text-align: justify;\">Il accorde aussi un bonus au lancement des sortil&egrave;ges et permet de contr&ocirc;ler un peu plus pr&eacute;cis&eacute;ment la dur&eacute;e des sorts.</p>",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        }
                      ],
                      "flow": "horizontal",
                      "align": "justify",
                      "type": "panel"
                    }
                  ],
                  "flow": "vertical",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "accessAlchemicalMagic",
                      "cssClass": "",
                      "role": "3",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Accès à la magie alchimique",
                      "defaultValue": null,
                      "size": "full-size",
                      "type": "checkbox",
                      "defaultChecked": false
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "accessAlchemicalMagic",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "m-small",
                          "icon": "",
                          "value": "${alchemicalMagicLevel}$",
                          "prefix": "Niveau ",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "<p style=\"text-align: justify;\">Ce pouvoir inné n’est accessible <strong>qu’aux êtres magiques</strong>. Le personnage possède des dons qui lui permettent d’apprendre relativement facilement des sorts alchimiques.</p>\n<p style=\"text-align: justify;\">Le niveau dans ce pouvoir indique le bonus au jet de dosage que reçoit intrinsèquement le personnage et ce quelle que soit la formule préparée.</p>\n<p style=\"text-align: justify;\">Ce pouvoir est permanent.</p>",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        }
                      ],
                      "flow": "horizontal",
                      "align": "justify",
                      "type": "panel"
                    }
                  ],
                  "flow": "vertical",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "powers",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "rowLayout": [
                    {
                      "key": "level",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.level}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Niveau"
                    }
                  ],
                  "head": true,
                  "deleteWarning": true,
                  "title": "<strong>Pouvoirs innées</strong>",
                  "hideEmpty": true,
                  "headDisplay": true,
                  "showDelete": true,
                  "statusIcon": false,
                  "nameAlign": "left",
                  "nameLabel": "Nom",
                  "templateFilter": [
                    "TOIxmn68EGfcsuRW"
                  ],
                  "itemFilter": [],
                  "type": "itemContainer"
                }
              ],
              "name": "Pouvoirs innés",
              "type": "tab"
            },
            {
              "key": "draconicMagicTav",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "or(2 == type, and(1 == type, accessDraconicMagic)) ? true : false",
              "contents": [
                {
                  "key": "manaPanel",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Récupération : ${recoveryMana}$",
                      "visibilityFormula": "",
                      "contents": [
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "Mana",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        },
                        {
                          "key": "mana",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": "",
                          "defaultValue": "",
                          "size": "m-small",
                          "allowDecimal": false,
                          "minVal": "0",
                          "maxVal": "${maxMana}$",
                          "allowRelative": false,
                          "showControls": true,
                          "controlsStyle": "hover",
                          "type": "numberField"
                        },
                        {
                          "key": "",
                          "cssClass": "",
                          "role": "0",
                          "permission": "0",
                          "tooltip": "",
                          "visibilityFormula": "",
                          "label": null,
                          "defaultValue": null,
                          "size": "full-size",
                          "icon": "",
                          "value": "/${maxMana}$",
                          "prefix": "",
                          "suffix": "",
                          "rollMessage": "",
                          "altRollMessage": "",
                          "style": "label",
                          "type": "label"
                        }
                      ],
                      "flow": "grid-3",
                      "align": "center",
                      "type": "panel"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Mana temporaire",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    },
                    {
                      "key": "temporaryMana",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "",
                      "size": "m-small",
                      "charList": "",
                      "maxLength": "",
                      "type": "textField"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "medium",
                      "icon": "",
                      "value": "Durée de conservation de la Mana temporaire",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    },
                    {
                      "key": "temporaryManaConservation",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "",
                      "size": "medium",
                      "charList": "",
                      "maxLength": "",
                      "type": "textField"
                    }
                  ],
                  "flow": "grid-5",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "Lancer 1d10 pour la durée",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "dice-d10",
                      "value": "Jet pour la durée de conservation de la Mana temporaire",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<h3>Durée de conservation de la Mana temporaire</h3>\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10]}$ jours ou minutes\n      </td>\n    </tr>\n  </tbody>\n</table>",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    }
                  ],
                  "flow": "vertical",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "spells",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "rowLayout": [
                    {
                      "key": "art",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.art}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Art"
                    },
                    {
                      "key": "description",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.description}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Description"
                    },
                    {
                      "key": "roll",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "dice-d10",
                      "value": "",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- roll-draconicMagic-spell -->\n\n<!-- \nPour le lancement du sort :\n* seuil = dépend du nombre de points de Mana impliqué (dépend du sort ou est variable) => saisie à faire au moment du jet\n* MODIFICATEURS à récupérer de la fiche : \n  * + niveau en magie draconique\n  * + niveau du sort\n-->\n\n${#concat(\n  ?{manaCost:\"Mana dépensée\"|\"1 à 5\"|\"6 à 10\"|\"11 à 15\"|\"16 à 20\"|\"21 à 24\"|\"25 et plus\"}\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#sante:=healthMalus}$\n\n${#seuil:= switchCase(manaCost, \"1 à 5\", 5, \"6 à 10\", 4, \"11 à 15\", 3, \"16 à 20\", 2, \"21 à 24\", 1, 0)}$\n\n${#magieDraconique:= draconicMagicLevel}$\n\n${#niveauSort:= item.level}$\n\n${#bonus:=((seuil + magieDraconique + niveauSort + modificateur + sante) > 10 ? seuil + magieDraconique + niveauSort + modificateur + sante - 10 : 0)}$\n\n<h3>Lancement du sort <strong>${!item.name}$</strong></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + magieDraconique + niveauSort + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Lancer le sort"
                    }
                  ],
                  "head": true,
                  "deleteWarning": true,
                  "title": "<strong>Sorts draconiques</strong>",
                  "hideEmpty": false,
                  "headDisplay": true,
                  "showDelete": true,
                  "statusIcon": false,
                  "nameAlign": "left",
                  "nameLabel": "Sort",
                  "templateFilter": [
                    "pUbJMnHnfGOeDy85"
                  ],
                  "itemFilter": [],
                  "type": "itemContainer"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Jet de masque sans métier ni hobby",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    }
                  ],
                  "flow": "vertical",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "unskilledMaskCharacteristic",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Caractéristique la plus appropriée",
                      "defaultValue": "",
                      "size": "full-size",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Jet de masque sans métier ni hobby",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- roll-draconicMagic -->\n\n${#concat(\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#seuil:= 4}$\n\n${#caracteristique:= first(fetchFromDynamicTable('characteristics', 'value', 'name', unskilledMaskCharacteristic), 0)}$\n\n${#sante:=healthMalus}$\n\n${#bonus:=((seuil + caracteristique + modificateur + sante) > 10 ? seuil + caracteristique + modificateur + sante - 10 : 0)}$\n\n<h3>Jet de masque sans métier/hobby qualifié${!0 != caracteristique ? concat(\" avec \", unskilledMaskCharacteristic) : \"\"}$</h3>\n<table>\n  <tbody>\n    <tr>\n      <td><h4>Jet du dé</h4></td>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + caracteristique + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- remise à zéro de la caractéristique utilisée -->\n${#setPropertyInEntity('self', 'unskilledMaskCharacteristic', 0)}$",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    }
                  ],
                  "flow": "horizontal",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Liste des masques créés",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    },
                    {
                      "key": "masks",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "",
                      "size": null,
                      "style": "dialog",
                      "type": "textArea"
                    }
                  ],
                  "flow": "vertical",
                  "align": "justify",
                  "type": "panel"
                }
              ],
              "name": "Magie draconique",
              "type": "tab"
            },
            {
              "key": "alchemicalMagicTab",
              "cssClass": null,
              "role": "0",
              "permission": "0",
              "tooltip": "",
              "visibilityFormula": "or(3 == type, accessAlchemicalMagic) ? true : false",
              "contents": [
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "accessDraconicMagic",
                  "contents": [
                    {
                      "key": "alchemicalMagicLevel",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "Niveau",
                      "defaultValue": "",
                      "size": "m-small",
                      "allowDecimal": false,
                      "minVal": "0",
                      "maxVal": "",
                      "allowRelative": false,
                      "showControls": false,
                      "controlsStyle": "hover",
                      "type": "numberField"
                    },
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "<p style=\"text-align: justify;\">Le personnage possède des dons qui lui permettent d’apprendre relativement facilement des sorts alchimiques.</p>\n<p style=\"text-align: justify;\">Le niveau dans ce pouvoir indique le bonus au jet de dosage que reçoit intrinsèquement le personnage et ce quelle que soit la formule préparée.</p>\n<p style=\"text-align: justify;\">Ce pouvoir est permanent.</p>",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label"
                    }
                  ],
                  "flow": "horizontal",
                  "align": "justify",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "contents": [
                    {
                      "key": "",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "Caractéristique pour le dosage",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "bold",
                      "type": "label"
                    },
                    {
                      "key": "dosageCharacteristic",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": "",
                      "defaultValue": "",
                      "size": "medium",
                      "options": [],
                      "tableKey": "characteristics",
                      "tableKeyColumn": "name",
                      "tableLabelColumn": "",
                      "formulaKeyOptions": null,
                      "formulaLabelOptions": null,
                      "type": "select"
                    }
                  ],
                  "flow": "horizontal",
                  "align": "center",
                  "type": "panel"
                },
                {
                  "key": "",
                  "cssClass": "",
                  "role": "0",
                  "permission": "0",
                  "tooltip": "",
                  "visibilityFormula": "",
                  "rowLayout": [
                    {
                      "key": "centuryOfWriting",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.centuryOfWriting}$<sup>ème</sup> s.",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Ancienneté"
                    },
                    {
                      "key": "maxPower",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${item.maxPower}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "center",
                      "colName": "Puissance maximale"
                    },
                    {
                      "key": "vector",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "",
                      "value": "${switchCase(item.vector, \"0\", \"Solide\", \"10\", \"Liquide\", \"20\", \"Gazeux\")}$",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Vecteur"
                    },
                    {
                      "key": "dosage",
                      "cssClass": "",
                      "role": "0",
                      "permission": "0",
                      "tooltip": "",
                      "visibilityFormula": "",
                      "label": null,
                      "defaultValue": null,
                      "size": "full-size",
                      "icon": "dice-d10",
                      "value": "",
                      "prefix": "",
                      "suffix": "",
                      "rollMessage": "<!-- roll for dosage -->\n\n${#concat(\n  ?{puissance:\"Puissance\"[number]|item.maxPower},\n  ?{modificateur:\"Modificateur\"[number]|0}\n)}$\n\n${#seuil:= 8}$\n${#magieAlchimique:= alchemicalMagicLevel}$\n\n${#caracteristique:= first(fetchFromDynamicTable('characteristics', 'value', 'name', dosageCharacteristic), 0)}$\n${#sante:= healthMalus}$\n\n${#anciennete:= item.centuryModificator}$\n\n${#vecteur:= switchCase(item.vector, \"0\", \"Solide\", \"10\", \"Liquide\", \"20\", \"Gazeux\", \"Vecteur non renseigné\")}$\n\n${#bonus:=((seuil + magieAlchimique + anciennete + caracteristique + modificateur + sante) > 10 ? seuil + magieAlchimique + anciennete + caracteristique + modificateur + sante - 10 : 0)}$\n\n<!-- contrôle de la puissance (inférieure ou égale à la puissance maximale) -->\n${#puissance:= min(item.maxPower, max(puissance, 0))}$\n\n<h3>Dosage de la formule <strong>${!item.name}$</strong>${!0 != caracteristique ? concat(\" avec \", dosageCharacteristic) : \"\"}$ (puissance ${!puissance}$)</h3>\n<table>\n  <tbody>\n    <tr>\n      <th>Jet du dé</th>\n      <td>\n        <strong>${roll:= [1d10] + bonus}$</strong> / ${seuil:= seuil + magieAlchimique + anciennete + caracteristique + modificateur + sante}$\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p style=\"padding: 2px; text-align: center; font-weight: bold; ${!roll<=seuil ? \"color: var(--color-level-success); border: solid 1px var(--color-level-success)\\\">Réussite\" : \"color: var(--color-level-error); border: solid 1px var(--color-level-error)\\\">Echec\"}$</p>\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <p>\n<!-- réussite : durée d'expiration du sort contenu dans le vecteur -->\n${!seuil >= roll ? (0 == item.vector ? \"Le sort n'expirera qu'à la destruction du vecteur\" : 10 == item.vector ? concat(\"Le sort dans le vecteur liquide expirera au bout de \",string(${![1d10]}$),\" jour(s)\") : 20 == item.vector ? concat(\"Le sort dans le vecteur gazeux expirera au bout de \",string(${![1d10]}$),\" heure(s)\") : \"\") : \"\"}$\n\n<!-- échec -->\n${#rollEffect:= [1d10]}$\n\n${!(roll > seuil ? switchCase(rollEffect, 1, concat(\"Le sort prend effet normalement \", string(${![1d10]}$),\" heures plus tard\"), 2, concat(\"Le sort prend effet normalement \", string(${![1d10]}$),\" heures plus tard\"), 3, concat(\"Le sort prend effet normalement \", string(${![1d10]}$),\" heures plus tard\"), 4, \"Le sort rate totalement mais les ingrédients peuvent être réutilisés\", 5, \"Le sort rate totalement mais les ingrédients peuvent être réutilisés\", 6, concat(\"Un ou plusieurs ingrédients ont été oubliés : <strong>\", replace([#Alchimie-Ingrédients-table 1], \", \", \" : \") ,\"</strong><br>Le travail sera suspendu jusqu'à ce qu'ils soient rajoutés.<br>Un nouveau jet de dosage sera alors réalisé.\"), 7, concat(\"Un ou plusieurs ingrédients ont été oubliés : <strong>\", replace([#Alchimie-Ingrédients-table 1], \", \", \" : \") ,\"</strong><br>Le travail sera suspendu jusqu'à ce qu'ils soient rajoutés.<br>Un nouveau jet de dosage sera alors réalisé.\"), 8, ((puissance - 2) > 0 ? concat(\"Le sort prend effet avec une puissance réduite : \", string(puissance - 2)) : \"Le sort rate et les ingrédients sont perdus\"), 9, ((puissance - 4) > 0 ? concat(\"Le sort prend effet avec une puissance réduite : \", string(puissance - 4)) : \"Le sort rate et les ingrédients sont perdus\"), \"Le sort rate totalement et les ingrédients sont perdus\")\n  : \"\"\n)}$\n        </p>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- remise à zéro de la caractéristique utilisée -->\n${#setPropertyInEntity('self', 'dosageCharacteristic', 0)}$",
                      "altRollMessage": "",
                      "style": "label",
                      "type": "label",
                      "align": "left",
                      "colName": "Dosage"
                    }
                  ],
                  "head": true,
                  "deleteWarning": true,
                  "title": "<strong>Formules d'alchimie</strong>",
                  "hideEmpty": false,
                  "headDisplay": true,
                  "showDelete": true,
                  "statusIcon": false,
                  "nameAlign": "left",
                  "nameLabel": "Formule",
                  "templateFilter": [
                    "kM4XQrctsu3ZixOZ"
                  ],
                  "itemFilter": [],
                  "type": "itemContainer"
                }
              ],
              "name": "Magie alchimique",
              "type": "tab"
            }
          ],
          "type": "tabbedPanel"
        }
      ],
      "key": "custom_body",
      "cssClass": null,
      "role": 0,
      "permission": 0,
      "tooltip": null,
      "visibilityFormula": null,
      "flow": null,
      "align": null,
      "type": "panel"
    },
    "display": {
      "width": "800",
      "height": "650",
      "fix_size": false,
      "pp_width": "128",
      "pp_height": "128"
    },
    "attributeBar": {},
    "activeEffects": {},
    "activeConditionalModifierGroups": [],
    "template": "KGZvMOZa6bJPhlh0",
    "props": {
      "name": "Assassin",
      "type": "2",
      "emergence": "0",
      "generation": "0",
      "age": "25",
      "stun": "0",
      "health": "0",
      "fightness": "0",
      "xp": "0",
      "healthMalusLabel": "Impact de l'état de santé :",
      "unskilledRoll": "Jet en tant que non qualifié",
      "healthMalus": "0",
      "stunStatus": "Tout va bien",
      "healthStatus": "Tout va bien",
      "ccArmorEquiped": "0",
      "distanceArmorEquiped": "0",
      "maxMana": "5",
      "recoveryMana": "1 par jour",
      "gender": "",
      "nationality": "",
      "unskilledCharacteristic": "",
      "characteristicForInitiative": "Vitesse",
      "fightnessPowerCheckbox": false,
      "ccCombatCarrier": "Garde du corps",
      "ccCombatHobby": "",
      "ccCombatCharacteristic": "",
      "contactCombatCarrier": "Garde du corps",
      "contactCombatHobby": "",
      "contactCombatCharacteristic": "",
      "distanceCombatCarrier": "Garde du corps",
      "distanceCombatHobby": "",
      "distanceCombatCharacteristic": "",
      "powerfullCharacteristic": "Force",
      "resistanceCharacteristic": "Endurance",
      "resistanceModificator": "4",
      "fightnessForAttack": "0",
      "fightnessForDefense": "0",
      "initiative": "2",
      "dragonFamily": "",
      "accessDraconicMagic": false,
      "accessAlchemicalMagic": false,
      "characteristics": {
        "0": {
          "deleted": false,
          "predefinedIdx": null,
          "name": "Force",
          "value": "4"
        },
        "1": {
          "deleted": false,
          "predefinedIdx": null,
          "name": "Endurance",
          "value": "4"
        },
        "2": {
          "deleted": false,
          "predefinedIdx": null,
          "name": "Vitesse",
          "value": "2"
        },
        "3": {
          "deleted": false,
          "predefinedIdx": null,
          "name": "Esprit d'initiative",
          "value": "-2"
        }
      },
      "mana": "0",
      "temporaryMana": "",
      "temporaryManaConservation": "",
      "unskilledMaskCharacteristic": "",
      "carriers": {
        "0": {
          "deleted": false,
          "predefinedIdx": null,
          "name": "Garde du corps",
          "level": "2",
          "characteristic": "",
          "roll": null
        }
      },
      "hobbies": {
        "0": {
          "deleted": true,
          "predefinedIdx": null,
          "name": "",
          "level": "4",
          "characteristic": "",
          "roll": null
        }
      }
    },
    "templateSystemUniqueVersion": 1442790790
  },
  "prototypeToken": {
    "name": "Assassin",
    "displayName": 40,
    "actorLink": false,
    "appendNumber": false,
    "prependAdjective": false,
    "texture": {
      "src": "icons/svg/mystery-man.svg",
      "scaleX": 1,
      "scaleY": 1,
      "offsetX": 0,
      "offsetY": 0,
      "rotation": 0
    },
    "width": 1,
    "height": 1,
    "lockRotation": false,
    "rotation": 0,
    "alpha": 1,
    "disposition": -1,
    "displayBars": 0,
    "bar1": {
      "attribute": null
    },
    "bar2": {
      "attribute": null
    },
    "light": {
      "alpha": 0.5,
      "angle": 360,
      "bright": 0,
      "coloration": 1,
      "dim": 0,
      "attenuation": 0.5,
      "luminosity": 0.5,
      "saturation": 0,
      "contrast": 0,
      "shadows": 0,
      "animation": {
        "type": null,
        "speed": 5,
        "intensity": 5,
        "reverse": false
      },
      "darkness": {
        "min": 0,
        "max": 1
      }
    },
    "sight": {
      "enabled": true,
      "range": 0,
      "angle": 360,
      "visionMode": "basic",
      "color": null,
      "attenuation": 0.1,
      "brightness": 0,
      "saturation": 0,
      "contrast": 0
    },
    "detectionModes": [],
    "flags": {},
    "randomImg": false
  },
  "items": [],
  "effects": [],
  "flags": {
    "custom-system-builder": {
      "version": "3.0.0"
    }
  },
  "_stats": {
    "systemId": "custom-system-builder",
    "systemVersion": "3.0.0",
    "coreVersion": "11.315",
    "createdTime": 1706881920740,
    "modifiedTime": 1706913392670,
    "lastModifiedBy": "r9x0pKEz3JGSJSrG"
  },
  "sort": 0,
  "ownership": {
    "default": 0,
    "r9x0pKEz3JGSJSrG": 3
  },
  "_key": "!actors!BPhbw4iwQ9KNHGTU"
}
